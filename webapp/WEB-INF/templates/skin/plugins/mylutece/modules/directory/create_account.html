<div id="one-zone-first" class="span-22 prepend-1 append-1 last">
    <div id="one-zone-first-content" class="portlet append-bottom -lutece-border-radius">

		<h2>#i18n{module.mylutece.directory.xpage.create_account.pageTitle}</h2>
		
		<#if form_error?? && form_error.hasError(  )>
			<div class="error">
				<#list form_error.errors?keys as message_key>
					<#assign error_messages = form_error.errors[message_key]>
					<#if error_messages?? && error_messages?has_content>
						<#list error_messages as error_message>
							${error_message}
							<br />
						</#list>
					</#if>
				</#list>
			</div>
		</#if>
		
		<#if action_successful?has_content>
			<h3>#i18n{module.mylutece.directory.message.create_account.success}</h3>
			<form class="default-form" id="createAccount" name="createAccount" action="${action_successful}" method="post">		
				<table align="center">
	            	<tr>
	                	<td>
							<input class="site-buttons" id="button-return" type="submit" name="BtnBack" value="#i18n{module.mylutece.directory.xpage.account.btnBack}" />
						</td>
					</tr>
	            </table>
			</form>
		<#elseif form_error?? && form_error.hasError( "error_directory_undefined" )>
			<div class="alert">#i18n{module.mylutece.directory.message.error.undefined}</div>			
		<#else>
	        <form class="default-form" id="createAccount" name="createAccount" action="jsp/site/Portal.jsp" method="post">
				<input type="hidden" name="plugin_name" value="${plugin_name}" />
				<input type="hidden" name="page" value="mylutecedirectory" />
				<input type="hidden" name="action" value="doCreateAccount" />
		        <fieldset>
			        <p>
			            <label class="text-label" for="login">#i18n{module.mylutece.directory.xpage.create_account.login} * : </label>
			            <input type="text" name="login" maxlength="100" size="35" tabindex="1" value="${(user.login)?if_exists}" />
			            <br />
			            <label class="text-label" for="password">#i18n{module.mylutece.directory.xpage.create_account.password} * : </label>
			            <input type="password" name="password" maxlength="100" size="35" tabindex="1" value="" />
			            <br />
			            <label class="text-label" for="confirmation">#i18n{module.mylutece.directory.xpage.create_account.confirmation} * : </label>
			            <input type="password" name="confirmation_password" maxlength="100" size="35" tabindex="1" value="" />
			            <br />	
						<div class="directory-entries">
							<#list entry_list as entry>	
				      			<#if entry.entryType.group>	
									<label class="text-label" for=""> ${entry.title} </label> 
			      					<#if entry.children?has_content>
			      						<#list entry.children as children >
			      							<#assign has_value = false>
			      							<#if map_id_entry_list_record_field??>
				      							<#assign entryKey= "" + children.idEntry>
				      							<#if map_id_entry_list_record_field[entryKey]??>
			      									${children.getHtmlFormEntry( locale, map_id_entry_list_record_field[entryKey], true )}
			      									<#assign has_value = true>
			      								</#if>
			      							</#if>
			      							<#if !has_value>
			      								${children.getHtmlFormEntry( locale,true )}
			      							</#if>
			      						</#list>
			      					</#if>
				      			<#else>
				      				<#assign has_value = false>
				      				<#if map_id_entry_list_record_field??>
				      					<#assign entryKey= "" + children.idEntry>
				      					<#if map_id_entry_list_record_field[entryKey]??>
				      						${entry.getHtmlFormEntry( locale, map_id_entry_list_record_field[entryKey], true )}
				      						<#assign has_value = true>
				      					</#if>
				      				</#if>
				      				<#if !has_value>
				      					${entry.getHtmlFormEntry( locale,true )}
				      				</#if>
				      			</#if>	
				      			<br />	      			
			      			</#list>
		      			</div>
		      			<p>
		            	<#--  <#if properties.captchaActive>  -->
							<#if is_active_captcha>
								<div >${captcha}</div>
							</#if>
						<#-- </#if>  -->
						</p>
					</p>					
	                <table align="center">
	                   	<tr>
	                       	<td>
								<input class="site-buttons" id="button-subscribe" type="submit" name="createAccountBtn" value="#i18n{module.mylutece.directory.xpage.create_account.btnCreateAccount}" />
	                        </td>
	                        <td>   
								<input class="site-buttons" id="button-return" type="button" name="back" value="#i18n{module.mylutece.directory.xpage.account.btnBack}" onclick='javascript:history.go(-1)'/>
	       	                </td>
	           	        </tr>
	               	</table>
				</fieldset>
			</form>
		</#if>
	</div>
</div>