<div id="one-zone-first" class="span-22 prepend-1 append-1 last">
    <div id="one-zone-first-content" class="portlet append-bottom -lutece-border-radius">

		<h2>#i18n{module.mylutece.directory.xpage.create_account.pageTitle}</h2>
		
		<#if error_code?has_content >
			<#assign typeClass = "class=\"error\"" />
			
			<#if error_code = "error_mandatory_fields">
				<div class="alert">#i18n{module.mylutece.directory.message.account.errorMandatoryFields}</div>
				<#if !(user.login?has_content)>
					<#assign classLogin = typeClass />
				</#if>
				<#if !(user.password?has_content)>
					<#assign classPassword = typeClass />
				</#if>
				<#if !(user.confirmation?has_content)>
					<#assign classConfirmation = typeClass />
				</#if>				
				
			</#if>
			<#if error_code = "error_confirmation_password">
				<div class="alert">#i18n{module.mylutece.directory.message.account.errorConfirmation}</div>
				<#assign classPassword = typeClass />
				<#assign classConfirmation = typeClass />
			</#if>
			<#if error_code = "error_login_already_exists">
				<div class="alert">#i18n{module.mylutece.directory.message.create_account.errorLogin}</div>
				<#assign classLogin = typeClass />
			</#if>		
			<#if error_code = "error_login_accents_or_blank">
				<div class="alert">#i18n{module.mylutece.directory.message.create_account.errorLogin.accents}</div>
				<#assign classLogin = typeClass />
			</#if>	
			
			<#if error_code = "error_jcaptcha">
				<div class="alert">#i18n{module.mylutece.directory.message.account.errorBadJcaptcha}</div>
			</#if>
			<#if error_code = "error_directory_field">
				<div class="alert">#i18n{module.mylutece.directory.message.mandatory.field}: ${error_field}</div>
			</#if>
			<#if error_code = "error_directory_message">
				<div class="alert">#i18n{module.mylutece.directory.message.error.field} ${error_field}: ${error_message}</div>
			</#if>
			
			
		</#if>		
		
		<#if action_successful?has_content>
			<h3>#i18n{module.mylutece.directory.message.create_account.success}</h3>
			<form class="default-form" id="createAccount" name="createAccount" action="${action_successful}" method="post">		
				<table align="center">
	            	<tr>
	                	<td>
							<input class="site-buttons" id="button-return" type="submit" name="BtnBack" value="#i18n{module.mylutece.directory.xpage.account.btnBack}" />
						</td>
					</tr>
	            </table>
			</form>
		<#elseif error_code?? && error_code = "error_directory_undefined">
				<div class="alert">#i18n{module.mylutece.directory.message.error.undefined}</div>			
		<#else>
	        <form class="default-form" id="createAccount" name="createAccount" action="jsp/site/plugins/mylutece/modules/directory/DoCreateAccount.jsp" method="post">
			<input type="hidden" name="plugin_name" value="${plugin_name}" />
	        <fieldset>
				
		        <p>
		            <label class="text-label" for="login">#i18n{module.mylutece.directory.xpage.create_account.login} * : </label>
		            <input type="text" ${classLogin?if_exists} name="login" maxlength="100" size="35" tabindex="1" value="${(user.login)?if_exists}" />
		            <br />
		            <label class="text-label" for="password">#i18n{module.mylutece.directory.xpage.create_account.password} * : </label>
		            <input type="password" ${classPassword?if_exists} name="password" maxlength="100" size="35" tabindex="1" value="" />
		            <br />
		            <label class="text-label" for="confirmation">#i18n{module.mylutece.directory.xpage.create_account.confirmation} * : </label>
		            <input type="password" ${classConfirmation?if_exists} name="confirmation_password" maxlength="100" size="35" tabindex="1" value="" />
		            <br />	
					<div class="directory-entries">
						<#list entry_list as entry>	
			      			<#if entry.entryType.group>	
			      			  	
			    					   <label class="text-label" for=""> ${entry.title} </label> 
			      					<#if entry.children?has_content>
			      						<#list entry.children as children >
			      							${children.getHtmlFormEntry( locale,true )}
			      						</#list>
			      					</#if>
			      				
			      			<#else>
			      				${entry.getHtmlFormEntry( locale,true )}	
			      			</#if>	
			      			<br />	      			
		      			</#list>
	      			</div>
	      			<p>
	            	<#--  <#if properties.captchaActive>  -->
						<#if is_active_captcha>
							<div >${captcha}</div>
						</#if>
					<#-- </#if>  -->
					</p>
				</p>					
                <table align="center">
                   	<tr>
                       	<td>
							<input class="site-buttons" id="button-subscribe" type="submit" name="createAccountBtn" value="#i18n{module.mylutece.directory.xpage.create_account.btnCreateAccount}" />
                        </td>
                        <td>   
							<input class="site-buttons" id="button-return" type="button" name="back" value="#i18n{module.mylutece.directory.xpage.account.btnBack}" onclick='javascript:history.go(-1)'/>
       	                </td>
           	        </tr>
               	</table>
			</fieldset>
			</form>
		</#if>
	</div>
</div>